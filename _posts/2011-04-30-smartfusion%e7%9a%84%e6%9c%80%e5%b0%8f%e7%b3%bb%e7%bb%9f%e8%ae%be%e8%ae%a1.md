---
layout: post
title: SmartFusion的最小系统设计
date: 2011-04-30 18:43
author: tglgg821
comments: true
categories: [Techniques]
---
一、项目简述

该项目是基于ACTEL公司的Smartfusion系列的芯片为核心，搭建的一个最小系统板。将相关的引脚和接口甩到插头上，用来增加扩展板，从而实现各种功能。

首先，从器件的选型说起。

选择核心处理芯片A2F200M3，理由有很多，主要有以下几点：

1、如同芯片资料所介绍的那样，该芯片由FPGA，ARM CORTEX M3核和可编程模拟通道组成，足以在很小的体积实现如此多的功能，确实非常吸引人。

2、该芯片不像ALTERA或者XLINX出的FPGA芯片那样，不用配置芯片，它将程序保存在芯片自带的FLASH上，这样显然在上电速度上有了很大的提高，同时也避免了在程序在下载过程中的意外情况，增加了一部分的可靠性。

3、ACTEL在西安的代理公司能提供给我三个样片，而且他们的售后也比较好，也许是比ALTERA小的缘故吧。

4、封装选用了256管脚的FBGA封装。

在该板上，一共使用了两种电源，分别是+3.3V和+1.5V，输入是+5V的电源。

+3.3V的电源转换芯片选用了LM1117DT-3.3V，这是个低压降正负电压调节器，主要特点是限流，热关闭。最大输出电流800mA，电压输出偏差±2%。封装选用了贴片的TO-252/TD03B_N封装。

+1.5V的电源转换芯片选用了LMS1587CS-1.5V，同样是个低压降正负电压调节器，该芯片的主要特点是快速响应。其最大输出电流3000mA，电压输出偏差±1%。封装选用了贴片的TO-263/TS3B_N。封装 这个芯片选的挺失败的，一是没有考虑其主要特点，二是查询RS之后得知在上海只有7片，量非常少。所以后边如果继续生产的话肯定得改。

电源芯片的选型目前看来一是根据系统需求考虑其主要特点，二是根据系统需要计算出其负载，如功率，电流等是否能够满足。这个还需要在后边的设计中不断完善。

A2F200M3芯片内部提供了100MHz的晶振，但是也可以加外部晶体。这里在外部按照评估板上的例子选择了32768Hz和20MHz的两个晶体。

32768Hz的晶体选了一个比较好的，频率稳定性60ppm，温度范围-20～+60<sup>0</sup>C。封装是直插型，2∅X6.2mm。

20MHz晶体同样选了一个直插型，频率稳定性50ppm，温度范围-20～+70<sup>0</sup>C。

参照评估板的电路，复位芯片选用DS1818，封装选用SOT-23。

在该最小系统上，增加了一块SPI接口的FLASH芯片，这里选用M25P80。这是一款8M，75Hz SPI总线接口的FLASH芯片。

JTAG接口借鉴评估板的资料绘制，没有什么改动。其余也就是些接头。

二、电路板的设计与关键点

1、电路板采用6层板。

2、核心芯片A2F200M3的电源引脚加0.01uF的去耦电容。

3、在+5V电源输入处加100pF，0.01uF，0.1uF，1uF，10uF，在电源转换芯片附近+3.3V和+1.5V输出的地方加100pF，0.01uF，0.1uF，1uF，10uF的去耦电容。

4、该芯片有个JTAG SEL引脚，我按照评估板的原理图绘制。但是ACTEL的工程师建议拉高。后来我还是增加了选择的地方。

&nbsp;

三、经验及问题

1、在设计板卡时，最好增加上电的POWER GOOD LED灯和调试参考的DEBUG LED灯，选择贴片的封装，大约是0805电容的大小，这样更直观和方便。

2、最好在关键位置留出检测点。

四、改进

1、参考了emcraft的板子，他们在板子上增加了16M PSRAM和8M NOR Flash。在此需要考虑硬件的存储容量是否能满足系统要求。

2、该电路板上应用了uCOS-ii作为实时系统，对于其实时性和多任务的性能，目前还在测试中。
